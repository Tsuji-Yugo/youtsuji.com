<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VDOT計算機</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .calculator {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select, input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
            display: none;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        .vdot-value {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
            color: #333;
        }
        .tabs {
            margin-top: 20px;
            overflow: hidden;
        }
        .tab-button {
            background-color: #f2f2f2;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 10px 15px;
            transition: 0.3s;
            font-size: 16px;
            border-radius: 4px 4px 0 0;
            margin-right: 2px;
        }
        .tab-button:hover {
            background-color: #ddd;
        }
        .tab-button.active {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-bottom: none;
        }
        .tab-content {
            display: none;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 0 4px 4px 4px;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <h1>VDOT計算機</h1>
    <div class="calculator">
        <div class="form-group">
            <label for="distance">距離を選択:</label>
            <select id="distance">
                <option value="1500">1.5km</option>
                <option value="5000">5km</option>
                <option value="10000">10km</option>
                <option value="21100">ハーフマラソン</option>
                <option value="42200">フルマラソン</option>
            </select>
        </div>
        <div class="form-group">
            <label for="hours">時間:</label>
            <input type="number" id="hours" min="0" max="24" value="0">
        </div>
        <div class="form-group">
            <label for="minutes">分:</label>
            <input type="number" id="minutes" min="0" max="59" value="0">
        </div>
        <div class="form-group">
            <label for="seconds">秒:</label>
            <input type="number" id="seconds" min="0" max="59" value="0">
        </div>
        <button onclick="calculateVDOT()">計算する</button>
        
        <div id="results" class="results">
            <div class="vdot-value">VDOT: <span id="vdot-result">-</span></div>
            
            <div class="tabs">
                <button class="tab-button active" onclick="openTab(event, 'paces-tab')">基本ペース</button>
                <button class="tab-button" onclick="openTab(event, 'intervals-tab')">インターバル距離</button>
            </div>
            
            <div id="paces-tab" class="tab-content" style="display: block;">
                <h3>トレーニングペース (基本)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>1 Mile</th>
                            <th>1 Km</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Easy</td>
                            <td id="easy-pace-mile">-</td>
                            <td id="easy-pace-km">-</td>
                        </tr>
                        <tr>
                            <td>Marathon</td>
                            <td id="marathon-pace-mile">-</td>
                            <td id="marathon-pace-km">-</td>
                        </tr>
                        <tr>
                            <td>Threshold</td>
                            <td id="threshold-pace-mile">-</td>
                            <td id="threshold-pace-km">-</td>
                        </tr>
                        <tr>
                            <td>Interval</td>
                            <td id="interval-pace-mile">-</td>
                            <td id="interval-pace-km">-</td>
                        </tr>
                        <tr>
                            <td>Repetition</td>
                            <td id="repetition-pace-mile">-</td>
                            <td id="repetition-pace-km">-</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div id="intervals-tab" class="tab-content">
                <h3>トレーニングペース (インターバル)</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>1200m</th>
                            <th>800m</th>
                            <th>600m</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Threshold</td>
                            <td id="threshold-1200">-</td>
                            <td id="threshold-800">-</td>
                            <td id="threshold-600">-</td>
                        </tr>
                        <tr>
                            <td>Interval</td>
                            <td id="interval-1200">-</td>
                            <td id="interval-800">-</td>
                            <td id="interval-600">-</td>
                        </tr>
                        <tr>
                            <td>Repetition</td>
                            <td id="repetition-1200">-</td>
                            <td id="repetition-800">-</td>
                            <td id="repetition-600">-</td>
                        </tr>
                    </tbody>
                </table>
                
                <table style="margin-top: 20px;">
                    <thead>
                        <tr>
                            <th>Type</th>
                            <th>400m</th>
                            <th>300m</th>
                            <th>200m</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Interval</td>
                            <td id="interval-400">-</td>
                            <td id="interval-300">-</td>
                            <td id="interval-200">-</td>
                        </tr>
                        <tr>
                            <td>Repetition</td>
                            <td id="repetition-400">-</td>
                            <td id="repetition-300">-</td>
                            <td id="repetition-200">-</td>
                        </tr>
                        <tr>
                            <td>Fast Reps</td>
                            <td id="fast-400">-</td>
                            <td id="fast-300">-</td>
                            <td id="fast-200">-</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // VDOT対応ペースのデータテーブル
        const paceData = {
            // VDOT: [Easy(min/mile), Easy(max/mile), Marathon(mile), Threshold(mile), Interval(mile), Repetition(mile)]
            30: [12.6, 13.8, 11.2, 10.5, 9.7, 9.2],
            31: [12.2, 13.4, 10.9, 10.2, 9.4, 8.9],
            32: [11.9, 13.1, 10.6, 9.9, 9.1, 8.7],
            33: [11.5, 12.7, 10.3, 9.6, 8.9, 8.4],
            34: [11.2, 12.4, 10.0, 9.4, 8.6, 8.2],
            35: [10.9, 12.0, 9.7, 9.1, 8.4, 8.0],
            36: [10.6, 11.7, 9.5, 8.9, 8.2, 7.8],
            37: [10.4, 11.4, 9.2, 8.6, 8.0, 7.6],
            38: [10.1, 11.1, 9.0, 8.4, 7.8, 7.4],
            39: [9.9, 10.9, 8.8, 8.2, 7.6, 7.2],
            40: [9.7, 10.6, 8.6, 8.0, 7.4, 7.0],
            41: [9.4, 10.4, 8.4, 7.8, 7.2, 6.9],
            42: [9.2, 10.2, 8.2, 7.7, 7.1, 6.7],
            43: [9.0, 10.0, 8.0, 7.5, 6.9, 6.6],
            44: [8.8, 9.7, 7.9, 7.3, 6.8, 6.4],
            45: [8.7, 9.5, 7.7, 7.2, 6.7, 6.3],
            46: [8.5, 9.3, 7.6, 7.1, 6.5, 6.2],
            47: [8.3, 9.2, 7.4, 7.0, 6.4, 6.1],
            48: [8.2, 9.0, 7.3, 6.8, 6.3, 6.0],
            49: [8.0, 8.8, 7.2, 6.7, 6.2, 5.9],
            50: [7.9, 8.7, 7.0, 6.6, 6.1, 5.8],
            51: [7.7, 8.5, 6.9, 6.5, 6.0, 5.7],
            52: [7.6, 8.4, 6.8, 6.4, 5.9, 5.6],
            53: [7.5, 8.2, 6.7, 6.3, 5.8, 5.5],
            54: [7.3, 8.1, 6.6, 6.2, 5.7, 5.4],
            55: [7.2, 8.0, 6.5, 6.1, 5.6, 5.3],
            56: [7.1, 7.8, 6.4, 6.0, 5.5, 5.2],
            57: [7.0, 7.7, 6.3, 5.9, 5.4, 5.2],
            58: [6.9, 7.6, 6.2, 5.8, 5.4, 5.1],
            59: [6.8, 7.5, 6.1, 5.7, 5.3, 5.0],
            60: [6.7, 7.4, 6.0, 5.6, 5.2, 4.9],
            61: [6.6, 7.3, 5.9, 5.5, 5.1, 4.9],
            62: [6.5, 7.2, 5.8, 5.5, 5.0, 4.8],
            63: [6.4, 7.1, 5.7, 5.4, 5.0, 4.7],
            64: [6.3, 7.0, 5.7, 5.3, 4.9, 4.7],
            65: [6.2, 6.9, 5.6, 5.2, 4.8, 4.6],
            66: [6.2, 6.8, 5.5, 5.2, 4.8, 4.5],
            67: [6.1, 6.7, 5.4, 5.1, 4.7, 4.5],
            68: [6.0, 6.6, 5.4, 5.0, 4.7, 4.4],
            69: [5.9, 6.5, 5.3, 5.0, 4.6, 4.4],
            70: [5.8, 6.4, 5.2, 4.9, 4.6, 4.3],
            71: [5.8, 6.4, 5.2, 4.9, 4.5, 4.3],
            72: [5.7, 6.3, 5.1, 4.8, 4.5, 4.2],
            73: [5.6, 6.2, 5.0, 4.7, 4.4, 4.2],
            74: [5.6, 6.1, 5.0, 4.7, 4.4, 4.1],
            75: [5.5, 6.1, 4.9, 4.6, 4.3, 4.1]
        };

        // 米マイルからキロメートルに変換する係数
        const MILE_TO_KM = 0.621371;

        // 文字列からペースを取得（分:秒形式からmin/km or min/mileを計算）
        function getPaceInMinutes(paceStr) {
            const parts = paceStr.split(':');
            const minutes = parseInt(parts[0], 10);
            const seconds = parts.length > 1 ? parseInt(parts[1], 10) : 0;
            return minutes + seconds / 60;
        }

        // 分単位のペースからフォーマットされた文字列を生成（例: 5.5 -> "5:30"）
        function formatPace(paceInMinutes) {
            const minutes = Math.floor(paceInMinutes);
            const seconds = Math.round((paceInMinutes - minutes) * 60);
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        // タイムからVDOT値を計算する関数
        function calculateVDOT() {
            const distance = parseInt(document.getElementById('distance').value);
            const hours = parseInt(document.getElementById('hours').value) || 0;
            const minutes = parseInt(document.getElementById('minutes').value) || 0;
            const seconds = parseInt(document.getElementById('seconds').value) || 0;
            
            const totalSeconds = hours * 3600 + minutes * 60 + seconds;
            if (totalSeconds === 0) {
                alert('有効なタイムを入力してください');
                return;
            }
            
            let vdot = calculateVdotValue(distance, totalSeconds);
            document.getElementById('vdot-result').textContent = vdot.toFixed(1);
            
            updatePaces(vdot);
            
            document.getElementById('results').style.display = 'block';
        }
        
        // VDOTに基づいてペース情報を更新
        function updatePaces(vdot) {
            // 最も近いVDOT値を見つける
            const vdotKeys = Object.keys(paceData).map(Number).sort((a, b) => a - b);
            
            let lowerVdot = vdotKeys[0];
            let upperVdot = vdotKeys[vdotKeys.length - 1];
            
            for (let i = 0; i < vdotKeys.length - 1; i++) {
                if (vdot >= vdotKeys[i] && vdot <= vdotKeys[i + 1]) {
                    lowerVdot = vdotKeys[i];
                    upperVdot = vdotKeys[i + 1];
                    break;
                }
            }
            
            // VDOT値に基づいて線形補間
            const ratio = (vdot - lowerVdot) / (upperVdot - lowerVdot);
            
            // 基本ペースの計算と表示
            // [Easy(min), Easy(max), Marathon, Threshold, Interval, Repetition]
            const lowerPaces = paceData[lowerVdot];
            const upperPaces = paceData[upperVdot];
            
            // ペースの線形補間計算
            const interpolatedPaces = lowerPaces.map((pace, index) => {
                return pace + ratio * (upperPaces[index] - pace);
            });
            
            // 基本ペース（マイル、キロメートル）の表示
            // Easy Pace (Mile & Km)
            document.getElementById('easy-pace-mile').textContent = 
                `${formatPace(interpolatedPaces[0])} ~ ${formatPace(interpolatedPaces[1])}`;
            document.getElementById('easy-pace-km').textContent = 
                `${formatPace(interpolatedPaces[0] * MILE_TO_KM)} ~ ${formatPace(interpolatedPaces[1] * MILE_TO_KM)}`;
            
            // Marathon Pace
            document.getElementById('marathon-pace-mile').textContent = formatPace(interpolatedPaces[2]);
            document.getElementById('marathon-pace-km').textContent = formatPace(interpolatedPaces[2] * MILE_TO_KM);
            
            // Threshold Pace
            document.getElementById('threshold-pace-mile').textContent = formatPace(interpolatedPaces[3]);
            document.getElementById('threshold-pace-km').textContent = formatPace(interpolatedPaces[3] * MILE_TO_KM);
            
            // Interval Pace
            document.getElementById('interval-pace-mile').textContent = formatPace(interpolatedPaces[4]);
            document.getElementById('interval-pace-km').textContent = formatPace(interpolatedPaces[4] * MILE_TO_KM);
            
            // Repetition Pace
            document.getElementById('repetition-pace-mile').textContent = formatPace(interpolatedPaces[5]);
            document.getElementById('repetition-pace-km').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM);
            
            // インターバルタイムの計算と表示
            // 距離係数（キロメートルに対する比率）
            const distFactors = {
                '1200': 1.2,
                '800': 0.8,
                '600': 0.6,
                '400': 0.4,
                '300': 0.3,
                '200': 0.2
            };
            
            // Threshold paces
            document.getElementById('threshold-1200').textContent = formatPace(interpolatedPaces[3] * MILE_TO_KM * distFactors['1200']);
            document.getElementById('threshold-800').textContent = formatPace(interpolatedPaces[3] * MILE_TO_KM * distFactors['800']);
            document.getElementById('threshold-600').textContent = formatPace(interpolatedPaces[3] * MILE_TO_KM * distFactors['600']);
            
            // Interval paces
            document.getElementById('interval-1200').textContent = formatPace(interpolatedPaces[4] * MILE_TO_KM * distFactors['1200']);
            document.getElementById('interval-800').textContent = formatPace(interpolatedPaces[4] * MILE_TO_KM * distFactors['800']);
            document.getElementById('interval-600').textContent = formatPace(interpolatedPaces[4] * MILE_TO_KM * distFactors['600']);
            document.getElementById('interval-400').textContent = formatPace(interpolatedPaces[4] * MILE_TO_KM * distFactors['400']);
            document.getElementById('interval-300').textContent = formatPace(interpolatedPaces[4] * MILE_TO_KM * distFactors['300']);
            document.getElementById('interval-200').textContent = formatPace(interpolatedPaces[4] * MILE_TO_KM * distFactors['200']);
            
            // Repetition paces
            document.getElementById('repetition-1200').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['1200']);
            document.getElementById('repetition-800').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['800']);
            document.getElementById('repetition-600').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['600']);
            document.getElementById('repetition-400').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['400']);
            document.getElementById('repetition-300').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['300']);
            document.getElementById('repetition-200').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['200']);
            
            // Fast Reps (約7%速い)
            const fastFactor = 0.93; // 7%速い
            document.getElementById('fast-400').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['400'] * fastFactor);
            document.getElementById('fast-300').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['300'] * fastFactor);
            document.getElementById('fast-200').textContent = formatPace(interpolatedPaces[5] * MILE_TO_KM * distFactors['200'] * fastFactor);
        }
        
        // VDOT値を計算する関数（表のデータに基づく内挿）
        function calculateVdotValue(distance, totalSeconds) {
            // 距離と時間からVDOTを推定するためのデータテーブル
            const distanceFactors = {
                1500: {
                    timeRange: [
                        { time: 240, vdot: 75 },
                        { time: 253, vdot: 70 },
                        { time: 267, vdot: 65 },
                        { time: 283, vdot: 60 },
                        { time: 300, vdot: 55 },
                        { time: 318, vdot: 50 },
                        { time: 339, vdot: 45 },
                        { time: 362, vdot: 40 },
                        { time: 387, vdot: 35 },
                        { time: 416, vdot: 30 }
                    ]
                },
                5000: {
                    timeRange: [
                        { time: 850, vdot: 75 },
                        { time: 895, vdot: 70 },
                        { time: 945, vdot: 65 },
                        { time: 1000, vdot: 60 },
                        { time: 1060, vdot: 55 },
                        { time: 1125, vdot: 50 },
                        { time: 1200, vdot: 45 },
                        { time: 1280, vdot: 40 },
                        { time: 1370, vdot: 35 },
                        { time: 1475, vdot: 30 }
                    ]
                },
                10000: {
                    timeRange: [
                        { time: 1750, vdot: 75 },
                        { time: 1850, vdot: 70 },
                        { time: 1950, vdot: 65 },
                        { time: 2075, vdot: 60 },
                        { time: 2200, vdot: 55 },
                        { time: 2340, vdot: 50 },
                        { time: 2490, vdot: 45 },
                        { time: 2660, vdot: 40 },
                        { time: 2850, vdot: 35 },
                        { time: 3060, vdot: 30 }
                    ]
                },
                21100: {
                    timeRange: [
                        { time: 3720, vdot: 75 },
                        { time: 3930, vdot: 70 },
                        { time: 4160, vdot: 65 },
                        { time: 4410, vdot: 60 },
                        { time: 4680, vdot: 55 },
                        { time: 4980, vdot: 50 },
                        { time: 5310, vdot: 45 },
                        { time: 5670, vdot: 40 },
                        { time: 6070, vdot: 35 },
                        { time: 6520, vdot: 30 }
                    ]
                },
                42200: {
                    timeRange: [
                        { time: 7740, vdot: 75 },
                        { time: 8190, vdot: 70 },
                        { time: 8670, vdot: 65 },
                        { time: 9180, vdot: 60 },
                        { time: 9750, vdot: 55 },
                        { time: 10380, vdot: 50 },
                        { time: 11070, vdot: 45 },
                        { time: 11820, vdot: 40 },
                        { time: 12660, vdot: 35 },
                        { time: 13600, vdot: 30 }
                    ]
                }
            };
            
            const timeRanges = distanceFactors[distance].timeRange;
            
            // タイムが範囲内かチェック
            if (totalSeconds <= timeRanges[0].time) {
                return timeRanges[0].vdot;
            }
            if (totalSeconds >= timeRanges[timeRanges.length-1].time) {
                return timeRanges[timeRanges.length-1].vdot;
            }
            
            // 適切な範囲を見つけて線形補間
            for (let i = 0; i < timeRanges.length - 1; i++) {
                if (totalSeconds >= timeRanges[i].time && totalSeconds <= timeRanges[i+1].time) {
                    const timeDiff = timeRanges[i+1].time - timeRanges[i].time;
                    const vdotDiff = timeRanges[i].vdot - timeRanges[i+1].vdot;
                    const ratio = (totalSeconds - timeRanges[i].time) / timeDiff;
                    return timeRanges[i].vdot - (ratio * vdotDiff);
                }
            }
            
            return 40; // デフォルト値
        }
        
        // タブ切り替え関数
        function openTab(evt, tabName) {
            // すべてのタブコンテンツを非表示
            const tabContents = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].style.display = "none";
            }

            // すべてのタブボタンから active クラスを削除
            const tabButtons = document.getElementsByClassName("tab-button");
            for (let i = 0; i < tabButtons.length; i++) {
                tabButtons[i].className = tabButtons[i].className.replace(" active", "");
            }

            // クリックされたタブコンテンツを表示し、対応するボタンを active に設定
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script>
</body>
</html>